var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},PopUp=function(t){function e(){var e=t.call(this)||this;return e.x=0,e.y=0,e.view=new egret.Sprite,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.show=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===i&&(i=!0);var n=0;t&&(n=500);var a=new egret.Shape;a.graphics.beginFill(0,.8),a.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),a.graphics.endFill(),e&&this.addChild(a),this.addChild(this.view),a.alpha=this.view.alpha=1,Global.fadeIn(a)},e.prototype.out=function(){Global.fadeOut(this);var t=egret.Tween.get(this.view);t.to({scaleX:1.2,scaleY:1.2},400,egret.Ease.cubicIn),t.call(function(){this.parent&&this.parent.removeChild(this)})},e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t},e}(egret.Sprite);__reflect(PopUp.prototype,"PopUp");var RedPacketItem=function(t){function e(e,i){var n=t.call(this)||this;n.canMove=!0;var a=Global.createBitmapByName("hb-rain_png");return a.scaleX=e,a.scaleY=i,n.icon=new Middle(a),n.addChild(n.icon),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickHandler,n),n}return __extends(e,t),e.prototype.clickHandler=function(){GameView.instance.scoreAdd(),CountDown.instance.isClick||(CountDown.instance.isClick=!0)},e}(egret.DisplayObjectContainer);__reflect(RedPacketItem.prototype,"RedPacketItem");var ErrorPop=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.view.y=-50;var i=Global.createBitmapByName("web_error_png");StageUtils.centerInParent(i,0,60),this.view.addChild(i)},e}(PopUp);__reflect(ErrorPop.prototype,"ErrorPop");var GameoverPop=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.view.y=-50;var i=Global.createBitmapByName("gameOver_png");StageUtils.centerInParent(i,0,0),this.view.addChild(i);var n=Global.createBitmapByName("playAgain_png");StageUtils.centerInParent(n,0,140),this.view.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgainHandler,this)},e.prototype.playAgainHandler=function(){this.parent.removeChild(this),GameView.instance.removeCount(),GameView.instance.addCount()},e}(PopUp);__reflect(GameoverPop.prototype,"GameoverPop");var GameView=function(t){function e(){var i=t.call(this)||this;return i.redPacketTimer=new egret.Timer(500),i.id=0,e.instance=i,i.initGameView(),i}return __extends(e,t),e.prototype.initGameView=function(){var t=this,e=Global.createBitmapByName("bg_jpg");e.width=StageUtils.SW,e.height=StageUtils.SH,e.x=0,e.y=0,this.addChild(e),this.redpacketList=new RedPacket,this.addChild(this.redpacketList),this.addCount();var i=Global.createBitmapByName("hand_png");i.x=330,i.y=390,this.addChild(i),egret.Tween.get(i).to({x:315,y:380},500).to({x:330,y:390},500).to({x:315,y:380},500).to({x:330,y:390},500).call(function(){t.removeChild(i)})},e.prototype.removeCount=function(){this.removeChild(this.countDown)},e.prototype.addCount=function(){this.countDown=new CountDown,this.addChild(this.countDown)},e.prototype.scoreAdd=function(){console.log("aaaa"),this.score&&this.removeChild(this.score),this.id++,this.id>25&&(this.id=25),this.score=new Score(this.id),this.score.x=40,this.score.y=StageUtils.SH-this.score.height-40,this.addChild(this.score)},e}(egret.DisplayObjectContainer);__reflect(GameView.prototype,"GameView");var HelpPop=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.view.y=-50;var i=Global.createBitmapByName("help-bg_png");StageUtils.centerInParent(i,0,60),this.view.addChild(i);var n=Global.createBitmapByName("help-title_png");StageUtils.centerInParent(n,0,-380),this.view.addChild(n);var a=new egret.ScrollView;a.width=473,a.height=720,this.view.addChild(a);var r=new CustomImage("resource/assets/help.png",!0,function(){a.setContent(r),StageUtils.centerInParent(a,0,70)}),o=Global.createBitmapByName("slide-up_png");StageUtils.centerInParent(o,0,500),this.view.addChild(o);var s=Global.createBitmapByName("close-btn_png");StageUtils.centerInParent(s,275,-345),this.view.addChild(s),s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){console.log("close popup"),Main.removePop("HelpPop")},this)},e}(PopUp);__reflect(HelpPop.prototype,"HelpPop");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=this,e=new CustomImage("resource/assets/loading/loading_bg.jpg",!0,function(){e.width=StageUtils.SW,e.height=StageUtils.SH});this.addChild(e),this.txtPro=new egret.TextField,this.txtPro.textColor=16777215,this.txtPro.size=26,this.txtPro.text="0%",this.txtPro.textAlign=egret.HorizontalAlign.CENTER,this.txtPro.width=200,this.txtPro.x=StageUtils.SW-this.txtPro.width>>1,this.txtPro.y=335,this.addChild(this.txtPro),this.fish=new CustomImage("resource/assets/loading/fish.png",!1,function(){t.fish.x=StageUtils.SW/2,t.fish.y=290+t.fish.height/2,t.fish.anchorOffsetX=t.fish.width/2,t.fish.anchorOffsetY=t.fish.height/2}),this.addChild(this.fish),this.addEventListener(egret.Event.ENTER_FRAME,function(){this.fish.rotation-=6},this)},e.prototype.setProgress=function(t,e){var i=Math.floor(t/e*100)+"%";this.txtPro.text=i},e.prototype.loadComp=function(){this.removeEventListener(egret.Event.ENTER_FRAME,function(){this.fish.rotation+=6},this),UIManager.instance.mainUILayer.removeChild(this),UIManager.instance.initMainView()},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(_super){function Main(){var t=_super.call(this)||this;return Main.instance=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(Main,_super),Object.defineProperty(Main,"USER_INFO_API",{get:function(){return Main.ROOT+"info?"+Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(Main,"PLAY_API",{get:function(){return Main.ROOT+"play?"+Math.random()},enumerable:!0,configurable:!0}),Main.prototype.onAddToStage=function(t){StageUtils.registStage(this.stage),this.addChild(UIManager.instance),this.loadingView=new LoadingUI,UIManager.instance.mainUILayer.addChild(this.loadingView),this.loadRes()},Main.prototype.getData=function(){var t=window.location.href.split("#")[0].split("?")[1];return-1!=t.indexOf("$share")?(Main.IS_SHARE=!0,Main.username=decodeURI(t.substr(0,t.indexOf("$share")))):(sessionStorage.setItem("interface","http://coeasion.cn/"),sessionStorage.setItem("mainticket",t.substr(0,32))),!0},Main.prototype.loadData=function(){if(Main.share(),this.getData())if(Main.IS_SHARE)Main.showPop("Share");else{var t=this;$.ajax({url:sessionStorage.getItem("interface"),data:{ticket:sessionStorage.getItem("mainticket")},success:function(e){"success"==e.result?0!=e.pools.length?(UserInfo.instance.isget=!1,sessionStorage.setItem("rewardTicket",e.pools[0].ticket),t.loadingView.loadComp()):(UserInfo.instance.isget=!0,Main.showPop("ReceivedPop")):Main.showPop("ErrorPop")},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})}else Main.showPop("ErrorPop")},Main.prototype.loadRes=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},Main.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},Main.prototype.onResourceLoadComplete=function(t){"loading"==t.groupName?RES.loadGroup("preload"):"preload"==t.groupName?(this.loadData(),RES.loadGroup("reward")):"reward"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this))},Main.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},Main.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},Main.showPop=function(t,e){void 0===e&&(e=null);var i=Main.list[t];if(i)return void Main.instance.addChild(i);var n=egret.getDefinitionByName(t),i=new n;i.setData(e),Main.instance.addChild(i),Main.list[t]=i},Main.removePop=function(t){var e=Main.list[t];e&&(e.parent&&e.out(),Main.list[t]=null,delete Main.list[t])},Main.share=function(isEnd){var _this=this;void 0===isEnd&&(isEnd=!1);var str1="码上有礼 新意加倍",str2="玩游戏就能赢红包，最高888元，快去看看!",url=window.location.href.split("#")[0].split("?")[0];if(url="http://res.leasiondata.cn/lstatic/hbRain/index.html?test$share1",eval("$.wxIsReady")){var weixin=eval("wx;");weixin&&(weixin.onMenuShareTimeline({title:"【"+str1+"】"+str2,link:url,imgUrl:"http://res.leasiondata.cn/lstatic/hbRain/share/share.jpg",success:function(){},cancel:function(){}}),weixin.onMenuShareAppMessage({title:str1,desc:str2,link:url,imgUrl:"http://res.leasiondata.cn/lstatic/hbRain/share/share.jpg",success:function(){},cancel:function(){}}))}else setTimeout(function(){_this.share()},100)},Main}(egret.DisplayObjectContainer);Main.ROOT="http://coeasion.cn/",Main.isTest=!0,Main.INFO_TICKET="",Main.PLAY_TICKET="",Main.IS_SHARE=!1,Main.list={},__reflect(Main.prototype,"Main");var MainView=function(t){function e(){var i=t.call(this)||this;return e.instance=i,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){var t=Global.createBitmapByName("bg_jpg");t.width=StageUtils.SW,t.height=StageUtils.SH,t.x=0,t.y=0,this.addChild(t),this.helpBtn=Global.createBitmapByName("help-btn_png"),this.helpBtn.x=StageUtils.SW-this.helpBtn.width-30,this.helpBtn.y=30,this.addChild(this.helpBtn),this.helpBtn.touchEnabled=!0,Global.setBut(this.helpBtn),this.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpHandler,this);var e=Global.createBitmapByName("theme_png");StageUtils.centerInParent(e),e.y=-220,this.addChild(e);var i=new CustomImage("resource/assets/hbb.png",!0,function(){i.x=350,i.y=110;var t=egret.Tween.get(i,{loop:!0});t.to({y:90},1e3).to({y:i.y},1e3)});this.addChild(i);var n=new CustomImage("resource/assets/hba.png",!0,function(){n.x=60,n.y=390;var t=egret.Tween.get(n,{loop:!0});t.to({y:410},1e3).to({y:n.y},1e3)});this.addChild(n),this.gametips=Global.createBitmapByName("click-tips_png"),this.gametips.x=StageUtils.SW/2,this.gametips.y=190+e.height+20+this.gametips.height/2,this.gametips.anchorOffsetX=this.gametips.width/2,this.gametips.anchorOffsetY=this.gametips.height/2,this.gametips.rotation=0,this.addChild(this.gametips),this.doudouHandler(),this.startBtn=Global.createBitmapByName("start_png"),StageUtils.centerInParentX(this.startBtn),this.startBtn.y=830,this.addChild(this.startBtn),this.startBtn.touchEnabled=!0,Global.setBut(this.startBtn),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startHandler,this),egret.Tween.get(e).to({y:190},200).call(function(){egret.Tween.get(e).to({y:130},300).call(function(){egret.Tween.get(e).to({y:190},200).call(function(){egret.Tween.get(e).to({y:180},120).call(function(){egret.Tween.get(e).to({y:190},80)})})})})},e.prototype.startHandler=function(){console.log("startGame"),UIManager.instance.mainUILayer.removeChild(this),UIManager.instance.showGame()},e.prototype.helpHandler=function(){Main.showPop("HelpPop")},e.prototype.doudouHandler=function(){var t=this;egret.Tween.get(this.gametips).wait(1e3).to({x:this.gametips.x+10,rotation:3},100).call(function(){egret.Tween.get(t.gametips).to({x:t.gametips.x-20,rotation:-3},100).call(function(){egret.Tween.get(t.gametips).to({x:t.gametips.x+20,rotation:3},100).call(function(){egret.Tween.get(t.gametips).to({x:t.gametips.x-10,rotation:0},100).call(function(){t.doudouHandler()})})})})},e}(egret.DisplayObjectContainer);__reflect(MainView.prototype,"MainView");var ReceivedPop=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.view.y=0;var i=Global.createBitmapByName("isGet_jpg");i.width=StageUtils.SW,i.height=StageUtils.SH,StageUtils.centerInParent(i,0,0),this.view.addChild(i)},e}(PopUp);__reflect(ReceivedPop.prototype,"ReceivedPop");var RedPacket=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.container=new egret.DisplayObjectContainer,this.addChild(this.container),this.listArr=[];for(var t=Global.createBitmapByName("hb-rain_png"),e=(t.width,t.height,-2);2>e;e++)for(var i=0;4>i;i++){var n=.4*Math.random()+.4,a=n,r=n,o=new RedPacketItem(a,r);this.container.addChild(o),1==i||3==i?o.x=320*e-350:o.x=350*e-150,o.y=350*i+150,this.listArr.push(o)}this.addEventListener(egret.Event.ENTER_FRAME,this.moveStart,this)},e.prototype.moveStart=function(){for(var t=this.listArr.length,e=0;t>e;e++){var i=this.listArr[e];i&&(i.x+=20,i.y+=20),(i.x>StageUtils.SW+i.width/2+150||i.y>StageUtils.SH+i.height+50)&&(i.x=-this.listArr[e].x+StageUtils.SW,i.y=-this.listArr[e].y+StageUtils.SH,i.x+=20,i.y+=20)}},e}(egret.DisplayObjectContainer);__reflect(RedPacket.prototype,"RedPacket");var EndView=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.view.y=-50;this.data=t;var e=Global.createBitmapByName("light_png");e.x=StageUtils.SW/2,e.y=StageUtils.SH/2,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.rotation=0,this.view.addChild(e),egret.Tween.get(e,{loop:!0}).to({alpha:.5}).to({alpha:1}),setInterval(function(){e.rotation+=6},100);var i=Global.createBitmapByName("reward-bg_png");StageUtils.centerInParent(i,15,0),this.view.addChild(i);if(t){var n=new CustomImage("resource/assets/reward/"+t.prizes[0].type+".png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=StageUtils.CH-200});if(this.view.addChild(n),"cash"==t.prizes[0].type){var a=new CustomImage("resource/assets/reward/"+t.prizes[0].value+".png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.CH+70});this.view.addChild(a);var r=Global.createBitmapByName("hbtips_png");StageUtils.centerInParent(r,0,290),this.view.addChild(r),this.getHb=Global.createBitmapByName("getHb-btn_png"),StageUtils.centerInParent(this.getHb,-140,450),this.view.addChild(this.getHb),this.getHb.touchEnabled=!0,this.getHb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getHbHandler,this);var o=Global.createBitmapByName("share-btn_png");StageUtils.centerInParent(o,140,450),this.view.addChild(o),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareHandler,this)}if("link"==t.prizes[0].type){var a=new CustomImage("resource/assets/reward/"+t.prizes[0].desc+".png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.CH+70});this.view.addChild(a);var s=Global.createBitmapByName("coupontips_png");StageUtils.centerInParent(s,0,290),this.view.addChild(s),this.getCp=Global.createBitmapByName("getCoupon-btn_png"),StageUtils.centerInParent(this.getCp,0,450),this.view.addChild(this.getCp),this.getCp.touchEnabled=!0,this.getCp.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.location.href=t.prizes[0].value},this)}}},e.prototype.getHbHandler=function(){if(this.getHb){this.view.removeChild(this.getHb);var t=Global.createBitmapByName("btn-ok_png");StageUtils.centerInParent(t,-140,450),this.view.addChild(t)}},e.prototype.shareHandler=function(){Main.showPop("SharePop")},e}(PopUp);__reflect(EndView.prototype,"EndView");var Score=function(t){function e(e){var i=t.call(this)||this;i.id=e;var n=Global.createBitmapByName("count"+e+"_png");return i.addChild(n),i}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Score.prototype,"Score");var Share=function(_super){function Share(){var t=_super.call(this)||this;return t.show(!1),t}return __extends(Share,_super),Share.prototype.show=function(t){_super.prototype.show.call(this,t),this.view.y=0;var e=Global.createBitmapByName("lingqu_jpg");e.width=StageUtils.SW,e.height=StageUtils.SH,StageUtils.centerInParent(e,0,0),this.view.addChild(e);var i=Global.createBitmapByName("erCode_png");StageUtils.centerInParent(i,0,95),this.view.addChild(i);var n=Global.createBitmapByName("got-it_png");StageUtils.centerInParent(n,0,370),this.view.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotItHandler,this)},Share.prototype.gotItHandler=function(){var weixin=eval("wx");weixin&&weixin.closeWindow()},Share}(PopUp);__reflect(Share.prototype,"Share");var SharePop=function(t){function e(){var e=t.call(this)||this;return e.show(!1),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.view.y=-50;var i=Global.createBitmapByName("share_png");StageUtils.centerInParent(i,0,-170),this.view.addChild(i);var n=Global.createBitmapByName("got-it_png");StageUtils.centerInParent(n,0,245),this.view.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotItHandler,this)},e.prototype.gotItHandler=function(){Main.removePop("SharePop")},e}(PopUp);__reflect(SharePop.prototype,"SharePop");var UserInfo=function(){function t(){this.smallsow_url="https://kdt.im/SMjyNr",this.isShare=!1,this.isget=!1}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}();__reflect(UserInfo.prototype,"UserInfo");var CustomImage=function(t){function e(e,i,n){void 0===i&&(i=!0),void 0===n&&(n=null);var a=t.call(this)||this;return a.url=e,a.isEase=i,a.compFunc=n,a.loadBg(),a}return __extends(e,t),e.prototype.loadBg=function(){RES.getResByUrl(this.url,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.onLoadComplete=function(t){this.texture=t,this.isEase&&(this.alpha=0,egret.Tween.get(this).to({alpha:1},1e3)),this.compFunc&&this.compFunc()},e}(egret.Bitmap);__reflect(CustomImage.prototype,"CustomImage");var Global=function(){function t(){}return t.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.fadeIn=function(e,i,n,a){void 0===i&&(i=0),void 0===n&&(n=500),void 0===a&&(a=1),t.tweenFrom(e,i,n,0,0,a,egret.Ease.cubicOut)},t.fadeOut=function(e,i,n,a){void 0===i&&(i=0),void 0===n&&(n=500),void 0===a&&(a=1),t.tweenToHide(e,i,n,0,0,a,egret.Ease.cubicOut)},t.tweenFrom=function(t,e,i,n,a,r,o){var s=egret.Tween.get(t),h=t.x,l=t.y;t.scaleX=t.scaleY=r,t.x=h+n,t.y=l+a,s.wait(e),s.to({alpha:1,scaleX:1,scaleY:1,x:h,y:l},i,o)},t.tweenToHide=function(t,e,i,n,a,r,o,s){void 0===s&&(s=0);var h=egret.Tween.get(t),l=t.x,c=t.y;l+=n,c+=a,h.wait(e),h.to({alpha:s,scaleX:r,scaleY:r,x:l,y:c},i,o),h.call(function(){t.parent&&t.parent.removeChild(t)})},t}();__reflect(Global.prototype,"Global");var Middle=function(t){function e(e){var i=t.call(this)||this;return e.x=e.width/-2,e.y=e.height/-2,i.addChild(e),i}return __extends(e,t),e}(egret.Sprite);__reflect(Middle.prototype,"Middle");var CountDown=function(t){function e(){var i=t.call(this)||this;return i.isClick=!1,i.index=5,i.angle=-90,e.instance=i,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.num=new egret.TextField,this.num.text="5",this.num.size=62,this.num.width=100,this.num.x=StageUtils.SW-this.num.width>>1,this.num.y=73,this.num.textAlign="center",this.addChild(this.num),this.timer=new egret.Timer(1e3,5),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHandler,this);var t=new CustomImage("resource/assets/time-circle1.png",!1,function(){StageUtils.centerInParentX(t),t.y=30});this.addChild(t);var e=new CustomImage("resource/assets/time-circle2.png",!1,function(){StageUtils.centerInParentX(e),e.y=30});this.addChild(e),this.timeCircle=new egret.Shape;var i=StageUtils.SW-t.width>>1;this.timeCircle.x=i,this.timeCircle.y=100,this.addChild(this.timeCircle),e.mask=this.timeCircle,egret.startTick(this.movestart,this),this.timer.start()},e.prototype.timerHandler=function(){if(this.index--,console.log(this.index),this.index>0)this.num.text=""+this.index;else{if(console.log("红包是否被点击："+e.instance.isClick),e.instance.isClick){var t=sessionStorage.getItem("rewardTicket");console.log("rewardTicket: "+t),void 0!=t&&$.ajax({url:Main.ROOT,data:{ticket:t},success:function(t){console.log(t),"success"==t.result?t.prizes[0].type&&Main.showPop("EndView",t):Main.showPop("ErrorPop")},error:function(t){},timeout:8e4,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})}else Main.showPop("GameoverPop");this.num.text=""+this.index,this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandler,this),this.timer=null}},e.prototype.changeGraphics=function(t){this.timeCircle.graphics.clear(),this.timeCircle.graphics.lineStyle(20,0,1),this.timeCircle.graphics.drawArc(0,0,60,-90*Math.PI/180,t*Math.PI/180,!1),this.timeCircle.graphics.endFill()},e.prototype.movestart=function(t){return this.angle+=1.25,this.changeGraphics(this.angle),this.angle>=270&&egret.stopTick(this.movestart,this),!1},e}(egret.DisplayObjectContainer);__reflect(CountDown.prototype,"CountDown");var StageUtils=function(){function t(){}return t.registStage=function(e){t.stage=e,t.SW=e.stageWidth,t.SH=e.stageHeight,t.CW=t.SW>>1,t.CH=t.SH>>1,t.LW=window.innerWidth,t.LH=window.innerHeight},t.centerInParentX=function(e,i){void 0===i&&(i=null),e&&(i?e.x=i.width-e.width>>1:e.x=t.stage.stageWidth-e.width>>1)},t.centerInParentY=function(e,i){void 0===i&&(i=null),e&&(i?e.y=i.height-e.height>>1:e.y=t.stage.stageHeight-e.height>>1)},t.centerInParent=function(e,i,n,a){void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=null),e&&(a?(e.x=(a.width-e.width>>1)+i,e.y=(a.height-e.height>>1)+n):(e.x=(t.stage.stageWidth-e.width>>1)+i,e.y=(t.stage.stageHeight-e.height>>1)+n))},t}();__reflect(StageUtils.prototype,"StageUtils");var UIManager=function(t){function e(){var e=t.call(this)||this;return e.initLayer(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.initLayer=function(){this.mainUILayer=new egret.DisplayObjectContainer,this.addChild(this.mainUILayer)},e.prototype.initMainView=function(){this.mainUILayer.addChild(new MainView)},e.prototype.showGame=function(){this.mainUILayer.addChild(new GameView)},e}(egret.DisplayObjectContainer);__reflect(UIManager.prototype,"UIManager");